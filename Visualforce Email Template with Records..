
Email Template



<messaging:emailTemplate subject="Expense" recipientType="User" relatedToType="Expense__c">
<messaging:htmlEmailBody >
 <html>
 <style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
   <body>
  
   
<apex:outputPanel rendered="{!if(relatedTo.User_Level__c=='Trainees' || relatedTo.User_Level__c=='IC1' || relatedTo.User_Level__c=='IC2' || relatedTo.User_Level__c=='IC3' ,true,false)}">
 <c:expenseApproval recId="{!relatedTo.Id}" />

 <table>
 <h4> Travel</h4>
  <tr>
    <th>Employee Category</th>
    <th>Mode of travel</th>
    <th>Class of travel</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Trainees, IC1, IC2,IC3</td>  
    <td>Rail / Bus</td>
    <td>2nd AC sleeper/ AC Sleeper bus</td>
    <td>Travel inland</td>
    <td>Train/ Bus/Taxi/Auto</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/> 
<table>
 <h4> Lodging</h4>
  <tr>
    <th>Employee Category</th>
    <th>Class A location</th>
    <th>Class B location</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Trainees, IC1, IC2,IC3</td>  
    <td>3500/-</td>
    <td>2500/-</td>
    <td>Travel inland</td>
    <td>Hotel A city/ Hotel B city</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/>
Class A :Ahmedabad, Banglore, Chandigarh, Chennai, Coimbatore,Greater Mumbai, Hyderabad, Indore, Jaipur, Kolkata,Ludhiana, Raipur, NCR and  Pune        
Class B :All others     
<br/> 
     
       <table>
 <h4> Fixed Daily Allowance/ Food</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Trainees, IC1, IC2,IC3</td>  
    <td>Rs. 550/- per day on tour</td>
    <td>Travel inland</td>
    <td>FDA</td>
    <td>Not Mandatory</td> 
  </tr>
</table>   
<br/>

Note for category1: Same day travel of 8 hours upto 16 hours will eligible for 50% FDA.

<br/>
         <table>
 <h4> Conveyance</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Rate per Kilometer</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Trainees, IC1, IC2,IC3</td>  
    <td>2 wheeler</td>
      <td>4.25/-</td>
    <td>conveyance</td>
    <td>2 wheeler/ 4 wheeler</td>
    <td>Not Mandatory</td> 
  </tr>
</table>  
<br/>
         <table>
 <h4> Telephone And Internet</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Trainees, IC1, IC2,IC3</td>  
  
      <td>1000/-</td>
    <td>TELEPHONE, FAX AND E-MAIL</td>
    <td>Mobile/ Internet</td>
    <td>Mandatory</td> 
  </tr>
</table>  
               
</apex:outputPanel>
   
<apex:outputPanel rendered="{!if(relatedTo.User_Level__c=='IC4' || relatedTo.User_Level__c=='IC5' || relatedTo.User_Level__c=='SM1' || relatedTo.User_Level__c=='SM2' ,true,false)}">
 <c:expenseApproval recId="{!relatedTo.Id}" />
 <table>
 <h4> Travel</h4>
  <tr>
    <th>Employee Category</th>
    <th>Mode of travel</th>
    <th>Class of travel</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC3,IC4, IC5, SM1, SM2</td>  
    <td>Rail / Bus/Air</td>
    <td>2nd AC sleeper/ AC Sleeper bus/Air Economy</td>
    <td>Travel inland/Travel inland air tickets(for air tickets)</td>
    <td>Train/ Bus/Taxi/Auto</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/> 
<table>
 <h4> Lodging</h4>
  <tr>
    <th>Employee Category</th>
    <th>Class A location</th>
    <th>Class B location</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC4, IC5, SM1, SM2</td>  
    <td>5000/-</td>
    <td>4000/-</td>
    <td>Travel inland</td>
    <td>Hotel A city/ Hotel B city</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/>
Class A :Ahmedabad, Banglore, Chandigarh, Chennai, Coimbatore,Greater Mumbai, Hyderabad, Indore, Jaipur, Kolkata,Ludhiana, Raipur, NCR and  Pune        
Class B :All others     
<br/> 
     
       <table>
 <h4> Fixed Daily Allowance/ Food</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC4, IC5, SM1, SM2</td>  
    <td>At actuals, restricted to RS.1500/-</td>
    <td>Travel inland</td>
    <td>Food</td>
    <td>Mandatory</td> 
  </tr>
</table>   
<br/>

Note for category1: Same day travel of 8 hours upto 16 hours will eligible for 50% FDA.

<br/>
         <table>
 <h4> Conveyance</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Rate per Kilometer</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC4, IC5, SM1, SM2</td>  
    <td>4 wheeler</td>
      <td>8.50/-</td>
    <td>conveyance</td>
    <td>2 wheeler/ 4 wheeler</td>
    <td>Not Mandatory</td> 
  </tr>
</table>  
<br/>
         <table>
 <h4> Telephone And Internet</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC4, IC5, SM1, SM2</td>  
  
      <td>1000/-</td>
    <td>TELEPHONE, FAX AND E-MAIL</td>
    <td>Mobile/ Internet</td>
    <td>Mandatory</td> 
  </tr>
</table>  
               
</apex:outputPanel>
<apex:outputPanel rendered="{!if(relatedTo.User_Level__c=='Management Team',true,false)}">
<c:expenseApproval recId="{!relatedTo.Id}" />
 <table>
 <h4> Travel</h4>
  <tr>
    <th>Employee Category</th>
    <th>Mode of travel</th>
    <th>Class of travel</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Management Team</td>  
    <td>Rail /Air</td>
    <td>2nd AC sleeper/ Air Economy</td>
    <td>Travel inland/Travel inland air tickets(for air tickets)</td>
    <td>Train/ Bus/Taxi/Auto</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/> 
<table>
 <h4> Lodging</h4>
  <tr>
    <th>Employee Category</th>
    <th>Class A location</th>
    <th>Class B location</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Management Team</td>  
    <td>7000/-</td>
    <td>6000/-</td>
    <td>Travel inland</td>
    <td>Hotel A city/ Hotel B city</td>
    <td>Mandatory</td> 
  </tr>
</table> 
<br/>
Class A :Ahmedabad, Banglore, Chandigarh, Chennai, Coimbatore,Greater Mumbai, Hyderabad, Indore, Jaipur, Kolkata,Ludhiana, Raipur, NCR and  Pune        
Class B :All others     
<br/> 
     
       <table>
 <h4> Fixed Daily Allowance/ Food</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Management Team</td>  
    <td>Actuals</td>
    <td>Travel inland</td>
    <td>Food</td>
    <td>Mandatory</td> 
  </tr>
</table>   
<br/>

Note for category1: Same day travel of 8 hours upto 16 hours will eligible for 50% FDA.

<br/>
         <table>
 <h4> Conveyance</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
    <th>Rate per Kilometer</th>
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>Management Team</td>  
    <td>4 wheeler</td>
      <td>8.50/-</td>
    <td>conveyance</td>
    <td>2 wheeler/ 4 wheeler</td>
    <td>Not Mandatory</td> 
  </tr>
</table>  
<br/>
         <table>
 <h4> Telephone And Internet</h4>
  <tr>
    <th>Employee Category</th>
    <th>Eligibility</th>   
   
    <th>Account head</th>
      <th>Item description</th>
    <th>Doc. Attachment</th>
  </tr>
  <tr>
    <td>IC4, IC5, SM1, SM2</td>  
  
      <td>1000/-</td>
    <td>TELEPHONE, FAX AND E-MAIL</td>
    <td>Mobile/ Internet</td>
    <td>Mandatory</td> 
  </tr>
</table>  
               
</apex:outputPanel>
 </body>
</html>
  
</messaging:htmlEmailBody>
 
</messaging:emailTemplate>

===================================================================
VF


<apex:component controller="Expense_Approval" access="global">
    <apex:attribute name="recId" type="String" description="Attribute for Task id" required="required" assignTo="{!currentid}" />
   

<!--<apex:dataTable value="{!Oppss}" var="a">

 <apex:column >
         <apex:facet name="header">Borrower Name</apex:facet>
         {!a.Name}
      </apex:column>
   
        </apex:dataTable>-->
    <h4>
        Expense Line Item Data
    </h4>
   <table class="table">
        <thead>    
            <tr>
                <th>Date</th> 
                <th>Account</th>
                <th>Item Data</th>
                 <th>Amount</th>
                 <th>Corrected Amount</th>
            </tr>
        </thead>        
        <tbody>
        <apex:repeat value="{!Oppss}" var="pos">
           
                <tr>
                    <td>{!pos.Date__c}</td>
                        <td>{!pos.Account__c}</td>
                        <td>{!pos.Item_Data__c}</td>      
                     <td>{!pos.Amount__c}</td>   
                     <td>{!pos.Corrected_Amount__c}</td>   
                </tr>
                   
        </apex:repeat>
        </tbody>   
    </table>
    
</apex:component>

=================================================================
Apex classs



global class Expense_Approval {
   global list<Expense_Line_Item__c> explinelist ;
    
    global id currentid { set; get;}
      global Expense__c account{
        get {
          account = [Select Id, name from Expense__c where id =: currentid];
          return account; }
       set;
    }
    global Expense_Approval(){
            
    }

     global List<Expense_Line_Item__c> Oppss{
        get{        
            explinelist = new List<Expense_Line_Item__c>();
            List<Expense_Line_Item__c> oppList = [select id,name,Date__c,Account__c,Item_Data__c,Amount__c,Corrected_Amount__c,
                                                  Expense__c from Expense_Line_Item__c where Expense__c=:currentid];
            for(Expense_Line_Item__c e:oppList){
                explinelist.add(e);
            }
              
            return explinelist;
        }
        set;
    }
     global String NewLine {
        get { return '\r\n'; }
        set;
    }
}
=======================
